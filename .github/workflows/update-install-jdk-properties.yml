name: Update install-jdk.properties

on: push

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: 'Checkout sources'
        uses: actions/checkout@v2

      - name: 'Configure git user'
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"

      - name: 'Set up Java'
        uses: actions/setup-java@v1
        with:
          java-version: 11

      - name: 'Show JDK builds listed at https://jdk.java.net'
        id: update
        run: |
          java src/bach/ShowJdkBuilds.java > install-jdk.properties
          git diff
          run: echo ::set-output name=modified::$(if git diff-index --quiet HEAD --; then echo "false"; else echo "true"; fi)

      - name: 'Commit and push changed install-jdk.properties'
        if: steps.update.outputs.modified == 'true'
        run: |
          git commit --all --message "Update install-jdk.properties"
          echo "git push origin master"

